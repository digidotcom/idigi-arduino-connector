<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    
    <title>Send Data Sample</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
    
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    
    <script type="text/javascript" src="utils.js"></script>
  </head>
<body onload="navlink()">
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><a href="index.html"><img alt="Logo" src="logo-idigi.gif"/></a></td>
  
  
  
   
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Send Data Sample </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock">
<table><tr>
<td valign="top">
  <div class="navtable" id='navtable' height='100%'>
  <div style='margin: 5px'>
    <ul class='NoBulletNoIndent'>
      <h4>Documentation</h4>
      <li><a href="index.html">Overview</a></li>
      <li><a href="getting_started.html">Getting Started</a></li>
      <li><a href="web_services.html">iDigi Web Services</a></li>

      <h4>API Details</h4>
      <li><a href="api_overview.html">Public API Overview</a></li>
      <li><a href="os_callbacks.html">Operating System</a></li>
      <li><a href="network_callbacks.html">Network</a></li>
      <li><a href="config_callbacks.html">Configuration</a></li>
      <li><a href="data_service.html">Data Service</a></li>
      <li><a href="firmware_download.html">Firmware Download</a></li>
      <li><a href="globals.html">Index</a></li>

      <h4>Samples</h4>
      <li><a href="send_data.html">Send Data</a></li>
      <li><a href="device_request_sample.html">Device Request</a></li>
      <li><a href="fw_download_sample.html">Firmware Download</a></li>

      <h4>More Info</h4>
      <li><a href="../../private/Readme.txt">Release Notes</a></li>
      <li><a href="../../iDigi Integration Kit End-User License Agreement.pdf">License</a></li>

      <h4>Support</h4>
      <li><a href="http://www.digi.com/contactus/email.jsp">Contact Support</a></li>
      <li><a href="http://www.digi.com/support">Support</a></li>
      <li><a href="http://forums.digi.com/support/forum/index">Discussion Forums</a></li>
    </ul>      
   </div>
   </div>
</td>
<td id='maintable' width="100%" valign="top">

<h2><a class="anchor" id="send_data_overview"></a>
Overview</h2>
<p>This sample demonstrates how to send data from a device to the iDigi Server. Using the <a class="el" href="data_service.html#data_service_overview">data service api</a> this application writes data to a file on the idigi server.</p>
<h2><a class="anchor" id="connect_description"></a>
Code Flow</h2>
<p>The routine main() in the platform directory initializes the IIK and registers the application-defined callback. In the file application.c is the application-defined callback idigi_callback(), this routine calls idigi_data_service_callback() when a data service request is received.</p>
<p>The routine application_run() (or application_step()) which is called after initialization calls the routine send_put_request() to initiate the data transfer to the iDigi Cloud. This routine initiates the data transfer by calling <a class="el" href="group__idigi__initiate__action.html#gabbb64d2c51de0c6f605196e48677b640" title="Request IIK to perform an action.">idigi_initiate_action()</a>; once the server is ready to receive data the idigi_data_service_callback() routine is called. The callback then returns the string "Welcome to iDigi data service sample!\n" back to the iDigi Cloud. This data is <b>copied</b> <b>into</b> <b>the</b> <b>callback's</b> <b>buffer</b>, the flags <a class="el" href="group__data__service__flags.html#ga445b103d3ffa638042addbd351eed6fb">IDIGI_MSG_LAST_DATA</a> and <a class="el" href="group__data__service__flags.html#ga92c09c11c6491f6dedd4c6669d0d5805">IDIGI_MSG_FIRST_DATA</a> indicate this is the only message in this data transfer. By modifying these flags you could modify this sample to send large amounts of data back to the server.</p>
<p>If idigi_data_service_callback() is called with <a class="el" href="group__idigi__data__service__type__t.html#gga5afb67c78869a035f7497363114ff6d3a3b73d3b3c5b77a44db0e14dbe45fa918">idigi_data_service_type_have_data</a> then this indicates a response from the server, <a class="el" href="group__idigi__data__service__type__t.html#gga5afb67c78869a035f7497363114ff6d3a25b587f16c8858b35856d0782980a1dd">idigi_data_service_type_error</a> would indicate an error is sent back from the server. In this example send_put_request() is called once a second from application_run() (or application_step()).</p>
<h2><a class="anchor" id="connect_build"></a>
Building</h2>
<p>To build this example for a Linux-based platform you can go into the directory public/run/samples/send_data and type make. If you are not running Linux you will need to setup your build system with the information described below and then build the image for your platform.</p>
<h3><a class="anchor" id="Source"></a>
Files</h3>
<p>The following is a list of source files required to build this sample:</p>
 
 <table class="apitable">
 <tr>
 <th class="title">Name</td>
 <th class="title">Description</td>
 <th class="title">Location</td>
 </tr>
 <tr>
 <th>application.c</th>
 <td>Contains application_run() and the application callback</td>
 <td>samples/send_data</td>
 </tr>
 <tr>
 <th>put_request.c</th>
 <td>data service callback and send_put_request() which starts the data transfer</td>
 <td>samples/send_data</td>
 </tr>
 <th>get_file.py</th>
 <td>Python script to retrieve a file</td>
 <td>samples/send_data</td>
 </tr>
 <tr>
 <th>idigi_api.c</th>
 <td>Code for the IIK </td>
 <td>private</td>
 </tr>
 <tr>
 <th>os.c</th>
 <td>Operating system calls</td>
 <td>platforms/<i>my_platform</i></td>
 </tr>
 <tr>
 <th>network.c</th>
 <td> Network interface </td>
 <td>platforms/<i>my_platform</i></td>
 </tr>
 <tr>
 <th>config.c</th>
 <td>Configuration routines</td>
 <td>platforms/<i>my_platform</i></td>
 </tr>
 <tr>
 <th>main.o</th>
 <td>Starting point of program, dependent on build environment</td>
 <td>platforms/<i>my_platform</i></td>
 </tr>
 </table>
 <h3><a class="anchor" id="Include"></a>
Paths</h3>
<p>The following include paths are required:</p>
<ul>
<li>public/include </li>
<li>run/platforms/linux (substitute with your platform)</li>
</ul>
<h3><a class="anchor" id="Defines"></a>
Defines</h3>
<p>The following defines are used in this sample:</p>
<ul>
<li>-DIDIGI_VERSION=0x1010000UL (indicates version 1.1 of the IIK)</li>
</ul>
<h2><a class="anchor" id="web_gui"></a>
Viewing results from iDigi Device Cloud</h2>
<p>To view the results for this sample login to the iDigi Device Cloud as described in the <a class="el" href="getting_started.html#add_your_device_to_the_cloud">Getting Started</a> section.</p>
<p>Once logged in click on storage from within the left navigation panel as shown below. Double click to the device folder.</p>
<div class="image">
<img src="sample1.png" alt="sample1.png"/>
</div>
<p>This sample creates a file test.txt in the test directory. Double click on the test folder to open the test directory.</p>
<div class="image">
<img src="send_data_sample3.png" alt="send_data_sample3.png"/>
</div>
<p>The file is then listed as shown (below). You can click on a file to view its contents, you will see the file test.txt in the test directory after you run this sample.</p>
<div class="image">
<img src="sample2.png" alt="sample2.png"/>
</div>
<h2><a class="anchor" id="python_script"></a>
Python script to retrieve a file from iDigi Device Cloud storage</h2>
<p>This sample provides a simple python script to retrive the test.txt file from developer.idigi.com after a device has sent test.txt into the server.</p>
<p>Run the python script in the sample.</p>
<div class="fragment"><pre class="fragment"> python get_file.py &lt;username&gt; &lt;password&gt; &lt;device_id&gt;
</pre></div><p>The script prints the content of test.txt. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer">
<center>
<a href="http://www.idigi.com">
</a> Copyright 1996-2011 Digi International Inc. All rights reserved.
</center>
</address>

</body>
</html>
