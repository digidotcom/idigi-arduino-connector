<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    
    <title>Getting Started</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
    
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    
    <script type="text/javascript" src="utils.js"></script>
  </head>
<body onload="navlink()">
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><a href="index.html"><img alt="Logo" src="logo-idigi.gif"/></a></td>
  
  
  
   
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Getting Started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock">
<table><tr>
<td valign="top">
  <div class="navtable" id='navtable' height='100%'>
  <div style='margin: 5px'>
    <ul class='NoBulletNoIndent'>
      <h4>Documentation</h4>
      <li><a href="index.html">Overview</a></li>
      <li><a href="getting_started.html">Getting Started</a></li>
      <li><a href="web_services.html">iDigi Web Services</a></li>

      <h4>API Details</h4>
      <li><a href="api_overview.html">Public API Overview</a></li>
      <li><a href="os_callbacks.html">Operating System</a></li>
      <li><a href="network_callbacks.html">Network</a></li>
      <li><a href="config_callbacks.html">Configuration</a></li>
      <li><a href="data_service.html">Data Service</a></li>
      <li><a href="firmware_download.html">Firmware Download</a></li>
      <li><a href="globals.html">Index</a></li>

      <h4>Samples</h4>
      <li><a href="send_data.html">Send Data</a></li>
      <li><a href="device_request_sample.html">Device Request</a></li>
      <li><a href="fw_download_sample.html">Firmware Download</a></li>

      <h4>More Info</h4>
      <li><a href="../../private/Readme.txt">Release Notes</a></li>
      <li><a href="../../iDigi Integration Kit End-User License Agreement.pdf">License</a></li>

      <h4>Support</h4>
      <li><a href="http://www.digi.com/contactus/email.jsp">Contact Support</a></li>
      <li><a href="http://www.digi.com/support">Support</a></li>
      <li><a href="http://forums.digi.com/support/forum/index">Discussion Forums</a></li>
    </ul>      
   </div>
   </div>
</td>
<td id='maintable' width="100%" valign="top">

<h2><a class="anchor" id="table_of_contents_porting"></a>
Getting Started</h2>
<p>The Getting Started process will walk you through the steps necessary to get the IIK integrated into your development environment and running applications which connect to the iDigi Device Cloud.</p>
<p>These steps include:</p>
<ol type="1">
<li><a class="el" href="getting_started.html#step1">Step 1: Determine if your compiler is C89 or C99 compliant</a><ol type="a">
<li><a class="el" href="getting_started.html#debug_macros">Implement the debug macros</a></li>
</ol>
</li>
<li><a class="el" href="getting_started.html#step2">Step 2: Modify idigi_config.h</a></li>
<li><a class="el" href="getting_started.html#step3">Step 3: Build the compile_and_link sample</a><ol type="a">
<li><a class="el" href="getting_started.html#idigi_initialization">IIK Initialization</a></li>
<li><a class="el" href="getting_started.html#add_files">Add the source files to your build system</a></li>
<li><a class="el" href="getting_started.html#add_path">Add the include paths</a></li>
<li><a class="el" href="getting_started.html#build_sample">Build the sample</a></li>
</ol>
</li>
<li><a class="el" href="getting_started.html#step4">Step 4: Setup your iDigi Account</a><ol type="a">
<li><a class="el" href="getting_started.html#idigi_login">Login to the iDigi Server</a></li>
<li><a class="el" href="getting_started.html#idigi_vendor_id">Obtain an iDigi Vendor ID</a></li>
</ol>
</li>
<li><a class="el" href="getting_started.html#step5">Step 5: Porting your platform for the connect_to_idigi sample</a><ol type="a">
<li><a class="el" href="getting_started.html#os_routines">OS Routines</a></li>
<li><a class="el" href="getting_started.html#network_routines">Network Routines</a></li>
<li><a class="el" href="getting_started.html#configuration_routines">Configuration Routines</a></li>
<li><a class="el" href="getting_started.html#application_start">iDigi Initialization</a></li>
</ol>
</li>
<li><a class="el" href="getting_started.html#step6">Step 6: Setup your build environment</a><ol type="a">
<li><a class="el" href="getting_started.html#add_c_files">Add the source files to your build system</a></li>
<li><a class="el" href="getting_started.html#add_include_paths">Add the include paths</a></li>
</ol>
</li>
<li><a class="el" href="getting_started.html#step7">Step 7: Build the connect_to_idigi sample</a></li>
<li><a class="el" href="getting_started.html#step8">Step 8: Run the connect_to_idigi sample</a><ol type="a">
<li><a class="el" href="getting_started.html#good_results_output">Example output from a successful run of connect_to_idigi</a></li>
<li><a class="el" href="getting_started.html#bad_results_output">Locating helpful error info in IIK standard output</a></li>
<li><a class="el" href="getting_started.html#add_your_device_to_the_cloud">Add your Device to the iDigi Device Cloud</a></li>
<li><a class="el" href="getting_started.html#view_result_on_cloud">Viewing Results on the iDigi Device Cloud</a></li>
</ol>
</li>
<li><a class="el" href="getting_started.html#step9">Step 9: Next Steps</a></li>
</ol>
<p>Two sample applications, <a class="el" href="getting_started.html#step3">compile_and_link</a> and <a class="el" href="getting_started.html#step7">connect_to_idigi</a>, will be used to confirm your compilation tool chain and integration, respectively. When complete, your device will be connected to the iDigi Device Cloud and be displayed in <a href="http://www.idigi.com/idigimanagerpro">iDigi Manager Pro</a>.</p>
<h2><a class="anchor" id="step1"></a>
Step 1: Determine if your compiler is C89 or C99 compliant</h2>
<p>The IIK is ANSI X3.159-1989 (ANSI C89) and ISO/IEC 9899:1999 (ANSI C99) compliant. If your compiler is ANSI C89 or C99 compliant and you are running on a 32-bit processor you can skip to the next section.</p>
<p>If your compiler is not ANSI C89 or C99 compliant, you will have to review (and edit) <a class="el" href="idigi__types_8h.html" title="Types required by the IIK.">public/include/idigi_types.h</a> to adjust the data types <a class="el" href="group__user__types.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>, <a class="el" href="group__user__types.html#ga273cf69d639a59973b6019625df33e30">uint16_t</a>, <a class="el" href="group__user__types.html#ga06896e8c53f721507066c079052171f8">uint32_t</a>.</p>
<ul>
<li><a class="el" href="group__user__types.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> </li>
<li><a class="el" href="group__user__types.html#ga273cf69d639a59973b6019625df33e30">uint16_t</a> </li>
<li><a class="el" href="group__user__types.html#ga06896e8c53f721507066c079052171f8">uint32_t</a></li>
</ul>
<p>Note by default these are defined for a 32-bit machine.</p>
<h3><a class="anchor" id="debug_macros"></a>
Implement the debug macros</h3>
<p>The file <a class="el" href="idigi__types_8h.html" title="Types required by the IIK.">public/include/idigi_types.h</a> implements the two macros listed below, which are used to debug the IIK.</p>
<ul>
<li><a class="el" href="group___d_e_b_u_g___m_a_c_r_o_s.html#ga8e5a1b02e45ebe8fea77b87c145bc56f">USER_DEBUG_VPRINTF</a> </li>
<li><a class="el" href="group___d_e_b_u_g___m_a_c_r_o_s.html#ga0966b817b229d48e5ffc7feab19a0be6">ASSERT</a></li>
</ul>
<p>Review these definitions and modify these for your platform:</p>
<p>If you don't have vprintf or assert available redefine these macros to call corresponding routines for your platform.</p>
<h2><a class="anchor" id="step2"></a>
Step 2: Modify idigi_config.h</h2>
<p>Open the file <a class="el" href="idigi__config_8h.html" title="IIK configuration options.">public/include/idigi_config.h</a> to configure processor endianess.</p>
<p>The IIK defaults to little endian. To reconfigure for big endian, comment out the <a class="el" href="group__idigi__config__options.html#ga3ef2cf25e8930717416a014d0f8f81ea">IDIGI_LITTLE_ENDIAN</a> define.</p>
<h2><a class="anchor" id="step3"></a>
Step 3: Build the compile_and_link sample</h2>
<p>In this step we are going to build the compile_and_link sample. This sample will verify that your build environment is set up correctly. You need to add the source files and include paths to your build system listed below.</p>
<h3><a class="anchor" id="idigi_initialization"></a>
IIK Initialization</h3>
<p>The routine <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> is called to initialize the IIK, currently this is called from the routine main() in main.c; you will need to call <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> at the initialization point for your application with an application callback. For the compile_and_link sample you can call <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> as:</p>
<div class="fragment"><pre class="fragment"> <span class="comment">// Call idigi_init() with a NULL callback to confirm your build environment only</span>
 <a class="code" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init</a>((<a class="code" href="group__idigi__callback__t.html#ga1a64686831c5c6f9c03cf8391fede0a7">idigi_callback_t</a>)0);
</pre></div><p>If you are not using main() you will need to add in the call to <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> where appropriate.</p>
<h3><a class="anchor" id="add_files"></a>
Add the source files to your build system</h3>
<p>The following is a list of files required to build. There is a sample linux Makefile provided (public/run/samples/compile_and_link/Makefile) which you can use as a reference. Add the following files to your make/build system.</p>
 
 <table class="apitable">
 <tr>
 <th class="title">Name</td>
 <th class="title">Description</td>
 <th class="title">Location</td>
 </tr>
 <tr>
 <td>idigi_api.c</td>
 <td>Contains the code for the IIK</td>
 <td>private</td>
 </tr>
 <tr>
 <td>main.c</td>
 <td>Program entry point, calls  <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a>  </td>
 <td>public/run/samples/compile_and_link</td>
 </tr>
 </table>
 <h3><a class="anchor" id="add_path"></a>
Add the include paths</h3>
<p>The following is a list of include paths to add to your system:</p>
<ul>
<li>public/include</li>
</ul>
<h3><a class="anchor" id="add_define"></a>
Add the defines</h3>
<p>The following define is required, and used to indicate that the version of the IIK is 1.1</p>
<ul>
<li>IDIGI_VERSION=0x1010000UL</li>
</ul>
<h3><a class="anchor" id="build_sample"></a>
Build the sample</h3>
<p>Now that you have the build environment setup, verify that you can compile and link. If you are using the Makefile provided, type make in the compile_and_link directory, otherwise execute the build for your system. If you are experiencing a build problem, double check the steps listed above. There is only one include path and two C files required to build this sample. Once the build is successful you can proceed to the next step.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Do not execute the compile_and_link sample, as this only verifies that the build environment is set up correctly. The application will exit on a failed ASSERT when run.</dd></dl>
<h2><a class="anchor" id="step4"></a>
Step 4: Setup your iDigi Account</h2>
<h3><a class="anchor" id="idigi_account"></a>
Create an iDigi Account</h3>
<p>Before getting started you will need to create a new iDigi account and obtain a unique iDigi Vendor ID (which is a unique identifier for your company).</p>
<p>Later in this process, when you get the connect_to_idigi sample <a class="el" href="getting_started.html#good_results_output">running successfully</a>, you will be <a class="el" href="getting_started.html#add_your_device_to_the_cloud">instructed to register</a> your Device ID with iDigi.</p>
<p>To create an account, navigate to <a href="https://developer.idigi.com/user_registration.do">https://developer.idigi.com/user_registration.do</a> and follow the instructions to create and register your iDigi account.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If you have already created and registered an iDigi Account, navigate here <a href="https://developer.idigi.com/">https://developer.idigi.com/</a> and follow the instructions in the next step.</dd></dl>
<div class="image">
<img src="idigi1.jpg" alt="idigi1.jpg"/>
</div>
<h3><a class="anchor" id="idigi_login"></a>
Login to the iDigi Server</h3>
<p>1. Login with the user credentials you created in section <a class="el" href="getting_started.html#idigi_account">Create an iDigi Account</a></p>
<div class="image">
<img src="idigi4.jpg" alt="idigi4.jpg"/>
</div>
<h3><a class="anchor" id="idigi_vendor_id"></a>
Obtain an iDigi Vendor ID</h3>
<p>2. If you are a first time iDigi developer, you will need to obtain an iDigi Vendor ID. To obtain an iDigi Vendor ID, select the register for Vendor ID button in the Vendor Information section on the bottom of the <b>My</b> <b>Account</b> tab after successfully logging into <a href="https://developer.idigi.com/">https://developer.idigi.com/</a>.</p>
<p>After selecting the register for a Vendor ID button, the page will refresh and your unique vendor ID number will be displayed in place of the button. Record the Vendor ID, you will need it later.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If you already have a vendor ID, it will be displayed instead of the button.</dd></dl>
<h2><a class="anchor" id="step5"></a>
Step 5: Porting your platform for the connect_to_idigi sample</h2>
<p>The <b>connect_to_idigi</b> sample validates the most fundamental IIK porting aspects. If you can successfully connect and stay connected to the iDigi cloud, all other IIK functions (like <a class="el" href="data_service.html#put_request">sending data</a> or <a class="el" href="firmware_download.html">firmware download</a>) should work without failure.</p>
<p>Go into the platforms directory and select a platform which is similar to your platform. If none of the available platforms are similar to yours, you can use the template platform.</p>
<p>In this guide we use the public/run/platforms/linux as an example, but all platforms have the same structure. So choose a platform (or copy an existing one) and go into that directory.</p>
<h3><a class="anchor" id="os_routines"></a>
OS Routines</h3>
<p>Open the file <a class="el" href="os_8c.html" title="Functions used by the IIK to interface to the OS.">os.c</a> and implement the routines listed below. For the linux platform the file is located at public/run/platforms/<em>my_platform/os.c</em>. Click on the routine to see a description, then modify to operate with your platform. These routines are callbacks which are described in the API section.</p>
<ul>
<li><a class="el" href="os_8c.html#a9dc0395e74b78f4bbe28c97edb1b3d6b" title="Dynamically allocate memory.">app_os_malloc()</a> </li>
<li><a class="el" href="os_8c.html#a55245355cccddb28eb351a6728714e22" title="Free Dynamically allocate memory.">app_os_free()</a> </li>
<li><a class="el" href="os_8c.html#a389dab616776482cb531e0994fb869c7" title="Get the system time.">app_os_get_system_time()</a> </li>
<li><a class="el" href="os_8c.html#a849afd0fdf4cd635d341184d89d063f0" title="Sleep or relinquish for other task execution.">app_os_sleep()</a></li>
</ul>
<h3><a class="anchor" id="network_routines"></a>
Network Routines</h3>
<p>Open the file <a class="el" href="network_8c.html" title="Rountines which implement the IIK network interface.">network.c</a> and implement the network interface routines. The network interface routines provided in the Linux platform are implemented using standard Berkeley socket calls and can be used as a reference for your platform. You may have to modify the routines in this file based on your platforms network implementation.</p>
<p>The following is a list of network interface routines which must be implemented: </p>
<ul>
<li><a class="el" href="network_8c.html#a9dc69781c58510962d0bbca3aef8cd86" title="Connect to the iDigi server.">app_network_connect()</a> </li>
<li><a class="el" href="network_8c.html#a03322df02ba77acec61357658cb02178" title="Send data to the iDigi server.">app_network_send()</a> </li>
<li><a class="el" href="network_8c.html#a8701f9056628d15ef7af3902b9516443" title="Receive data from the iDigi server.">app_network_receive()</a> </li>
<li><a class="el" href="network_8c.html#aaae5942657b1cd15f43d223de127ceb7" title="Close the connection to the iDigi server.">app_network_close()</a></li>
</ul>
<h3><a class="anchor" id="configuration_routines"></a>
Configuration Routines</h3>
<p>In this step we set up the configuration routines for your platform. Each configuration item has a corresponding get routine for retrieving its value. Open the file <a class="el" href="config_8c.html" title="Configuration routines for the IIK.">config.c</a> for your platform and implement the configuration routines. All configuration routines are passed in a pointer to a pointer, along with a pointer to the size. The address of the configuration item is stored in the pointer passed in, and the size is assigned to the pointer to the size variable. For example, <a class="el" href="config_8c.html#a31d9d8bad0ad2e9fc08fb86bdd9c1582" title="Get the iDigi server URL.">app_get_server_url()</a> is the routine used to retrieve the iDigi Device Cloud URL and is shown below. </p>
<div class="fragment"><pre class="fragment">  <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="config_8c.html#a31d9d8bad0ad2e9fc08fb86bdd9c1582" title="Get the iDigi server URL.">app_get_server_url</a>(<span class="keywordtype">char</span> ** url, <span class="keywordtype">size_t</span> * size)
  {
<span class="preprocessor">  #error &quot;Specify iDigi Server URL&quot; // This #error must be removed to compile</span>
<span class="preprocessor"></span>      <span class="comment">// Statically allocated string containing the sever URL</span>
      <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *idigi_server_url = <span class="stringliteral">&quot;developer.idigi.com&quot;</span>;
  
      <span class="comment">// Fill in the pointer with the address of the URL in memory</span>
      *url = (<span class="keywordtype">char</span> *)idigi_server_url;
      <span class="comment">// Fill in the size</span>
      *size = strlen(idigi_server_url);
  
      <span class="keywordflow">return</span> 0;
  }
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>The required routines contain the  #error  preprocessor directive which must be removed before compiling.</dd>
<dd>
The memory assigned to configuration items must be <b>statically</b> <b>allocated</b> and is accessed by the IIK after the routine returns.</dd></dl>
<p>The following is a list of configuration routines which need to be implemented for your platform, please review each routine: </p>
<ul>
<li><a class="el" href="config_8c.html#af797bde6064d097e5ca359264362e367" title="Get the IP address of the device.">app_get_ip_address()</a> </li>
<li><a class="el" href="config_8c.html#a827d9eefecdf87ae59a3a1472e79bb2b" title="Get the MAC address of the device.">app_get_mac_addr()</a> </li>
<li><a class="el" href="config_8c.html#a46991622a2ed9a10dfa212520bc899ac" title="Get the iDigi device ID.">app_get_device_id()</a> </li>
<li><a class="el" href="config_8c.html#a7c8083af6e04ca00e7e4d2ae43a52549" title="Get the iDigi vendor ID.">app_get_vendor_id()</a> </li>
<li><a class="el" href="config_8c.html#ac660a95cf2f2f59822c4c89bbf2befd0" title="Get the device type.">app_get_device_type()</a> </li>
<li><a class="el" href="config_8c.html#a31d9d8bad0ad2e9fc08fb86bdd9c1582" title="Get the iDigi server URL.">app_get_server_url()</a> </li>
<li><a class="el" href="config_8c.html#a9536ef091d7e6f9083d3754370595f89" title="Get the connection type.">app_get_connection_type()</a> </li>
<li><a class="el" href="config_8c.html#a875a6e3faf565d67002e8b2797f14e6e" title="Get the link speed.">app_get_link_speed()</a> </li>
<li><a class="el" href="config_8c.html#a8cc77a993ff3e4963afac9d312e44ef4" title="Get the WAN phone number.">app_get_phone_number()</a> </li>
<li><a class="el" href="config_8c.html#a24cf0dc8ff9aaaec7f538301f69e0adb" title="Get the TX keepalive interval.">app_get_tx_keepalive_interval()</a> </li>
<li><a class="el" href="config_8c.html#a37f048759ef3eb18cac8f2ed7fa5d6eb" title="Get the RX keepalive interval.">app_get_rx_keepalive_interval()</a> </li>
<li><a class="el" href="config_8c.html#a2c72dd53db0807607bb31e6a770797c3" title="Get the wait count.">app_get_wait_count()</a> </li>
<li><a class="el" href="config_8c.html#ab1b921910d85e6996a3423abd1a4d4d5" title="Return true if firmware download is supported.">app_get_firmware_support()</a> </li>
<li><a class="el" href="config_8c.html#a00e2239b128f1a071eacd35a29050b3d" title="Return true if the data service is supported.">app_get_data_service_support()</a> </li>
<li><a class="el" href="config_8c.html#a400d349f550cf8ed2dc3f5c3d0546862" title="Return maximum transactions.">app_get_max_message_transactions()</a> </li>
<li><a class="el" href="config_8c.html#a95500fed93f0e24d87e8e3e61e7ab2b1" title="Error status notification.">app_config_error()</a></li>
</ul>
<dl class="note"><dt><b>Note:</b></dt><dd>For information on using hard coded values instead of these configuration callbacks, which helps to reduce the IIK code space, see <a class="el" href="group__idigi__config__data__options.html">Hard Coded Application Configuration options</a></dd></dl>
<h3><a class="anchor" id="application_start"></a>
iDigi Initialization</h3>
<p>As in the <a class="el" href="getting_started.html#step3">compile_and_link</a> sample, you must make a call to <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a>. However, in this sample, you will execute the code, making all the networking, configuration, and operating system callbacks.</p>
<p>The <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> call, must now include a proper callback:</p>
<div class="fragment"><pre class="fragment"> <span class="comment">// Initialize the IIK with the application callback</span>
 idigi_handle = <a class="code" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init</a>((<a class="code" href="group__idigi__callback__t.html#ga1a64686831c5c6f9c03cf8391fede0a7">idigi_callback_t</a>) idigi_callback);
</pre></div><p>and placed in location capable of starting a network client.</p>
<p>Its recommended that you use the code inside main() and cut and paste, as is, into an appropriate spot. In the Linux platform provided, the routine main() creates a thread which then calls <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a>. You will need to set up a similar thread in your environment (or call <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a>) periodically.</p>
<p>This thread is shown below: </p>
<div class="fragment"><pre class="fragment"> <span class="keyword">static</span> <span class="keywordtype">void</span> * idigi_run_thread(<span class="keywordtype">void</span> * arg)
 {
     <a class="code" href="group__idigi__status__t.html#gafa4546937c115989dd1d558bcdc06dfd">idigi_status_t</a> status;
 
     APP_DEBUG(<span class="stringliteral">&quot;idigi_run thread starts\n&quot;</span>);
 
     <span class="comment">// Run the IIK, this will only return on an IIK abort</span>
     status = <a class="code" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run</a>((<a class="code" href="group__idigi__handle__t.html#ga67c0491c4011285039100aa356c50582">idigi_handle_t</a>)arg);
 
     APP_DEBUG(<span class="stringliteral">&quot;idigi_run thread exits %d\n&quot;</span>, status);
 
     pthread_exit(arg);
 }
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>The <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> call must successfully complete prior to any other IIK call (i.e., <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a>, <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a>).</dd></dl>
<h2><a class="anchor" id="step6"></a>
Step 6: Setup your build environment</h2>
<h3><a class="anchor" id="add_c_files"></a>
Add the source files to your build system</h3>
<p>To build the connect_to_idigi sample you will need to add the files shown below to your build environment.</p>
 
 <table class="apitable">
 <tr>
 <th class="title">Name</td>
 <th class="title">Description</td>
 <th class="title">Location</td>
 </tr>
 <tr>
 <td>idigi_api.c</td>
 <td>Contains the code for the IIK</td>
 <td>private</td>
 </tr>
 <tr>
 <td>application.c</td>
 <td>Contains the code which runs the sample and main callback that calls
 callbacks in os.c, network.c, & config.c</td>
 <td>public/run/samples/connect_to_idigi</td>
 </tr>
 <tr>
 <td>os.c</td>
 <td>Operating System Routines</td>
 <td>public/run/platforms/<i>my_platform</i></td>
 </tr>
 <tr>
 <td>network.c</td>
 <td>Network Interface</td>
 <td>public/run/platforms/<i>my_platform</i></td>
 </tr>
 <tr>
 <td>config.c</td>
 <td>Configuration Routines</td>
 <td>public/run/platforms/<i>my_platform</i></td>
 </tr>
 <tr>
 <td>main.c (if applicable)</td>
 <td>Program entry point, calls  <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a>  </td>
 <td>public/run/platforms/<i>my_platform</i></td>
 </tr>
 </table>
 <h3><a class="anchor" id="add_include_paths"></a>
Add the include paths</h3>
<p>The following is a list of include paths you will need to add to your build system:</p>
<ul>
<li>public/include </li>
<li>run/platforms/<em>my_platform</em> </li>
</ul>
<h2><a class="anchor" id="step7"></a>
Step 7: Build the connect_to_idigi sample</h2>
<p>Next, build the sample. If you are running on Linux you can simply type make in the directory public/run/samples/connect_to_idigi, if you are not using Linux then you will have to build for your environment.</p>
<h2><a class="anchor" id="step8"></a>
Step 8: Run the connect_to_idigi sample</h2>
<p>The name of the executable generated by the Linux Makefile is called idigi. In Linux, type ./idigi from a console to execute the program.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>By default <a class="el" href="group__idigi__config__options.html#gae0a42315e30656478ca8748a88defed1">IDIGI_DEBUG</a> is defined in <a class="el" href="idigi__config_8h.html" title="IIK configuration options.">idigi_config.h</a>, which prints helpful IIK Library debug messages to the standard output.</dd></dl>
<h3><a class="anchor" id="good_results_output"></a>
Example output from a successful run of connect_to_idigi</h3>
<p>Below is the standard output shown for a successful <a class="el" href="getting_started.html#step7">connect_to_idigi</a> run:</p>
<div class="fragment"><pre class="fragment">  &gt;./idigi
  Start iDigi
  initialize_facilities: callback supports  13 facility
  initialize_facilities: callback supports  14 facility
  <a class="code" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run</a> thread starts
  application_run thread exits 0
  <a class="code" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run</a> thread starts
  dns_resolve_name: ip address = [50.56.41.153]
  network_connect: connected to [developer.idigi.com] server
  communication layer: Send MT Version
  communication layer: receive Mt version
  communication layer: send keepalive params
  communication layer: Rx keepalive parameter = 60
  communication layer: Tx keepalive parameter = 90
  communication layer: Wait Count parameter = 5
  initialization layer: send protocol version
  initialization layer: receive protocol version
  Security layer: send security form
  security layer: send device ID =  00 00 00 00 00 00 00 00 00 40 9D FF FF 43 23 17
  security layer: send server url = developer.idigi.com
  discovery layer: send vendor <span class="keywordtype">id</span> =  01 00 00 1A
  discovery layer: send device type = connect to idigi DVT
  fw_discovery: No target supported
  Connection Control: send redirect_report
  <span class="keyword">get</span> packet buffer: send pending
  Connection Control: send redirect_report
  Connection Control: send connection report
  get_ip_address: Looking <span class="keywordflow">for</span> current device IP address: found [2] entries
  get_ip_address: 1: Interface name [lo]  IP Address [127.0.0.1]
  get_ip_address: 2: Interface name [eth3]        IP Address [10.52.32.71]
  get_ip_addr: Device IP address =  0A 34 20 47
  get_connection_type: connection type = 0
  get_mac_addr: MAC address =  00 40 9D 43 23 17
  discovery layer: send complete
  idigi_facility_layer: receive data facility = 0x00c0
  rx_keepalive_process: time to send Rx keepalive
</pre></div><h3><a class="anchor" id="bad_results_output"></a>
Locating helpful error info in IIK standard output</h3>
<p>When an error occurs, since APP_DEBUG is defined as printf in your <a class="el" href="platform_8h_source.html">platform.h</a> file, critical errors are displayed via the <a class="el" href="group__idigi__config__request__t.html#gga48906e16d7c01c72b5549b12d663001cab2b82246aeafc5b3ef69d908cf697d24">idigi_config_error_status</a> callback. Below is an example with an output showing an error related to the <a class="el" href="group__idigi__config__request__t.html#gga48906e16d7c01c72b5549b12d663001ca822eb4a28e41cbd49394715724f3db9b">idigi_config_server_url</a> callback. By searching through your application code, you can easily trace this callback to the <a class="el" href="config_8c.html#a31d9d8bad0ad2e9fc08fb86bdd9c1582" title="Get the iDigi server URL.">app_get_server_url()</a> porting function:</p>
<div class="fragment"><pre class="fragment">  &gt;./idigi
  Start iDigi
  initialize_facilities: callback supports  13 facility
  initialize_facilities: callback supports  14 facility
  <a class="code" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run</a> thread starts
  application_run thread exits 0
  <a class="code" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run</a> thread starts
  idigi_error_status: Config - <a class="code" href="group__idigi__config__request__t.html#gga48906e16d7c01c72b5549b12d663001ca822eb4a28e41cbd49394715724f3db9b">idigi_config_server_url</a> (3)  status = <a class="code" href="group__idigi__status__t.html#ggafa4546937c115989dd1d558bcdc06dfdaeb4d020c259e803770005fb5c8978177">idigi_invalid_data_range</a> (4)
  <a class="code" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run</a> thread exits 4
  &gt;
</pre></div><p>Given this output, a thorough code review of the <a class="el" href="config_8c.html#a31d9d8bad0ad2e9fc08fb86bdd9c1582" title="Get the iDigi server URL.">app_get_server_url()</a> function should reveal a porting defect.</p>
<h3><a class="anchor" id="add_your_device_to_the_cloud"></a>
Add your Device to the iDigi Device Cloud</h3>
<p>The next several sections walk through the steps required to add your device to the iDigi Device Cloud.</p>
<ol type="1">
<li>Navigate to <a href="http://www.idigi.com">http://www.idigi.com</a> and login to the iDigi Device Cloud</li>
<li>Click on Devices from within the left navigation panel.</li>
<li>Click the Add Devices button (the + button under Devices) to bring up the Add Devices dialog.</li>
</ol>
<div class="image">
<img src="add1.png" alt="add1.png"/>
</div>
<p>Within the Add Devices dialog click the Add Manually&gt;&gt; button.</p>
<div class="image">
<img src="add2.png" alt="add2.png"/>
</div>
<p>Select Device ID: from the drop-down menu.</p>
<div class="image">
<img src="add3.png" alt="add3.png"/>
</div>
<p>Enter the Device ID for your device then click the Add button.</p>
<div class="image">
<img src="add4.png" alt="add4.png"/>
</div>
<p>Click the OK button to add your device to the iDigi Device Cloud.</p>
<div class="image">
<img src="add5.png" alt="add5.png"/>
</div>
<h3><a class="anchor" id="view_result_on_cloud"></a>
Viewing Results on the iDigi Device Cloud</h3>
<p>Click the Refresh button. The device will reconnect to the iDigi Device Cloud. If successful your device Status will show connected. You can now communicate with your device over the iDigi cloud. The next step is to integrate in one of the samples to add in more functionality to your application.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If you cannot connect to the iDigi Device cloud, the most likely problem is in the iDigi Configuration, review the configuration routines in <a class="el" href="config_8c.html" title="Configuration routines for the IIK.">config.c</a>; The device ID and vendor ID must be valid to connect.</dd></dl>
<div class="image">
<img src="results1.png" alt="results1.png"/>
</div>
<h2><a class="anchor" id="step9"></a>
Step 9: Next Steps</h2>
<p>Now that you have a basic sample up and running with the iDigi Device Cloud, you can port in more functionality to your application. We first suggest reading the <a class="el" href="api_overview.html#api1_overview">API</a> section of the documentation and then select a sample which has the functionality you need. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer">
<center>
<a href="http://www.idigi.com">
</a> Copyright 1996-2011 Digi International Inc. All rights reserved.
</center>
</address>

</body>
</html>
