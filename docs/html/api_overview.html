<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    
    <title>Public API Overview</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
    
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    
    <script type="text/javascript" src="utils.js"></script>
  </head>
<body onload="navlink()">
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><a href="index.html"><img alt="Logo" src="logo-idigi.gif"/></a></td>
  
  
  
   
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Public API Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock">
<table><tr>
<td valign="top">
  <div class="navtable" id='navtable' height='100%'>
  <div style='margin: 5px'>
    <ul class='NoBulletNoIndent'>
      <h4>Documentation</h4>
      <li><a href="index.html">Overview</a></li>
      <li><a href="getting_started.html">Getting Started</a></li>
      <li><a href="web_services.html">iDigi Web Services</a></li>

      <h4>API Details</h4>
      <li><a href="api_overview.html">Public API Overview</a></li>
      <li><a href="os_callbacks.html">Operating System</a></li>
      <li><a href="network_callbacks.html">Network</a></li>
      <li><a href="config_callbacks.html">Configuration</a></li>
      <li><a href="data_service.html">Data Service</a></li>
      <li><a href="firmware_download.html">Firmware Download</a></li>
      <li><a href="globals.html">Index</a></li>

      <h4>Samples</h4>
      <li><a href="send_data.html">Send Data</a></li>
      <li><a href="device_request_sample.html">Device Request</a></li>
      <li><a href="fw_download_sample.html">Firmware Download</a></li>

      <h4>More Info</h4>
      <li><a href="../../private/Readme.txt">Release Notes</a></li>
      <li><a href="../../iDigi Integration Kit End-User License Agreement.pdf">License</a></li>

      <h4>Support</h4>
      <li><a href="http://www.digi.com/contactus/email.jsp">Contact Support</a></li>
      <li><a href="http://www.digi.com/support">Support</a></li>
      <li><a href="http://forums.digi.com/support/forum/index">Discussion Forums</a></li>
    </ul>      
   </div>
   </div>
</td>
<td id='maintable' width="100%" valign="top">

<h2><a class="anchor" id="api1_overview"></a>
Public API Overview</h2>
<p>The IIK API includes two major software interfaces: </p>
<ul>
<li>IIK function calls </li>
<li>IIK application-defined callback</li>
</ul>
<p>The functions available in the IIK are listed below:  
 <table class="apitable">
 <tr>
 <th class="title">Routine</td>
 <th class="title">Description</td>
 </tr>
 <tr>
 <th> <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a>  </th>
 <td>Start the IIK</td>
 </tr>
 <tr>
 <th> <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a>  </th>
 <td>Execute the IIK and return</td>
 </tr>
 <tr>
 <th> <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a>  </th>
 <td>Start the IIK and do not return</td>
 </tr>
 <tr>
 <th> <a class="el" href="group__idigi__initiate__action.html#gabbb64d2c51de0c6f605196e48677b640" title="Request IIK to perform an action.">idigi_initiate_action()</a>  </th>
 <td>Begin an IIK operation, like starting a data transfer</td>
 </tr>
 </table>
 <h3><a class="anchor" id="initialization"></a>
Initialization: idigi_init()</h3>
<p>The function <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> is called once at startup to initialize the IIK. The application-defined callback function is passed as an argument; the <a class="el" href="group__idigi__callback__t.html">application-defined callback</a> is used by the IIK to communicate with the application. The <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> function must be called before all other IIK APIs.</p>
<h3><a class="anchor" id="single_threaded"></a>
Single-threaded model: idigi_step()</h3>
<p>The function <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a> is called to perform a sequence of operations or events and then returns control back to the caller. This allows a caller to perform other tasks within a single thread or round robin based control loop. A caller must call this API repeatedly to continue IIK operations.</p>
<p>The <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a> performs the following operations:</p>
<ol type="1">
<li>Establish and maintain a connection with the iDigi Device Cloud.</li>
<li>Wait for incoming messages from the iDigi Device Cloud.</li>
<li>Send outstanding messages to the iDigi Device Cloud.</li>
</ol>
<h3><a class="anchor" id="multi_threaded"></a>
Multi-threaded model: idigi_run()</h3>
<p>The function <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a> is similar to <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a> except it blocks and doesn't return control back to caller unless the IIK encounters an error. This function is typically executed as a separate thread. This is the recommended method of running the IIK within in a multithreaded environment.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>To relinquish control of the CPU in a multithreaded environment the IIK calls the receive (<a class="el" href="network_8c.html#a8701f9056628d15ef7af3902b9516443">app_network_receive</a>) callback with a timeout or will call OS sleep (<a class="el" href="os_8c.html#a849afd0fdf4cd635d341184d89d063f0">app_os_sleep</a>).</dd></dl>
<h3><a class="anchor" id="initiate_action"></a>
Initiate an action: idigi_initiate_action()</h3>
<p>The function <a class="el" href="group__idigi__initiate__action.html#gabbb64d2c51de0c6f605196e48677b640" title="Request IIK to perform an action.">idigi_initiate_action()</a> is used to indicate to the IIK to perform a device-requested action. The currently supported actions are:</p>
<ul>
<li>Initiate a data transfer to the server, described in the data service API </li>
<li>Terminate the IIK</li>
</ul>
<h3><a class="anchor" id="iik_callback"></a>
Application Callback</h3>
<p>The IIK uses a single application-defined <a class="el" href="group__idigi__callback__t.html">callback</a> function to process network events, handle operating system (OS) calls, return device configuration data, and process firmware updates. The callback is also used to report error status and event notification. The application-defined <a class="el" href="group__idigi__callback__t.html">callback</a> is passed into <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> upon startup. When the IIK needs to allocate memory, access the network or perform other actions the application defined callback is called.</p>
<p>The IIK will invoke the application-defined callback to perform the following actions: </p>
<ul>
<li>Obtain configuration information </li>
<li>OS calls </li>
<li>Networking calls </li>
<li>Notify the application of critical events and status </li>
<li>Firmware download </li>
<li>Handle a device request </li>
<li>Request more data when sending data to the iDigi Device Cloud</li>
</ul>
<p><b>Class</b> <b>ID</b> and <b>Request</b> <b>ID</b> enumeration values are used to identify the callback action. The application must perform and return the appropriate action and return data, according to the class and request enumeration values.</p>
<p>Each callback is passed in a Class ID which is defined by the enumerated type <a class="el" href="group__idigi__class__t.html">Class IDs</a>. For each Class ID there is a set of Request ID's, for example the <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33afbfd38403093d8e58eeb3f8ac1971181">idigi_class_operating_system</a> the corresponding Request ID's are defined by the enum <a class="el" href="group__idigi__os__request__t.html">OS Request IDs</a>.</p>
<p>The parameters for the application-defined callback: request_data, request_length, response_data and response_length are defined by the corresponding class_id and the request_id. There is a section in the documentation for each class of callbacks. For example, the Operating System callbacks are described on the <a class="el" href="os_callbacks.html">Operating System</a> page. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer">
<center>
<a href="http://www.idigi.com">
</a> Copyright 1996-2011 Digi International Inc. All rights reserved.
</center>
</address>

</body>
</html>
