<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    
    <title>Firmware Download</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
    
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    
    <script type="text/javascript" src="utils.js"></script>
  </head>
<body onload="navlink()">
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><a href="index.html"><img alt="Logo" src="logo-idigi.gif"/></a></td>
  
  
  
   
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Firmware Download </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock">
<table><tr>
<td valign="top">
  <div class="navtable" id='navtable' height='100%'>
  <div style='margin: 5px'>
    <ul class='NoBulletNoIndent'>
      <h4>Documentation</h4>
      <li><a href="index.html">Overview</a></li>
      <li><a href="getting_started.html">Getting Started</a></li>
      <li><a href="web_services.html">iDigi Web Services</a></li>

      <h4>API Details</h4>
      <li><a href="api_overview.html">Public API Overview</a></li>
      <li><a href="os_callbacks.html">Operating System</a></li>
      <li><a href="network_callbacks.html">Network</a></li>
      <li><a href="config_callbacks.html">Configuration</a></li>
      <li><a href="data_service.html">Data Service</a></li>
      <li><a href="firmware_download.html">Firmware Download</a></li>
      <li><a href="globals.html">Index</a></li>

      <h4>Samples</h4>
      <li><a href="send_data.html">Send Data</a></li>
      <li><a href="device_request_sample.html">Device Request</a></li>
      <li><a href="fw_download_sample.html">Firmware Download</a></li>

      <h4>More Info</h4>
      <li><a href="../../private/Readme.txt">Release Notes</a></li>
      <li><a href="../../iDigi Integration Kit End-User License Agreement.pdf">License</a></li>

      <h4>Support</h4>
      <li><a href="http://www.digi.com/contactus/email.jsp">Contact Support</a></li>
      <li><a href="http://www.digi.com/support">Support</a></li>
      <li><a href="http://forums.digi.com/support/forum/index">Discussion Forums</a></li>
    </ul>      
   </div>
   </div>
</td>
<td id='maintable' width="100%" valign="top">

<h2><a class="anchor" id="fw_overview1"></a>
Firmware Download</h2>
<ol type="1">
<li><a class="el" href="firmware_download.html#fw_overview">Overview</a></li>
<li><a class="el" href="firmware_download.html#fw_num_targets">Number of Firmware Targets</a></li>
<li><a class="el" href="firmware_download.html#fw_version_number">Version Number of Firmware Target</a></li>
<li><a class="el" href="firmware_download.html#fw_code_size">Code Size of Firmware Target</a></li>
<li><a class="el" href="firmware_download.html#fw_description">Description of Firmware Target</a></li>
<li><a class="el" href="firmware_download.html#fw_namespec">File Name Spec of Firmware Target</a></li>
<li><a class="el" href="firmware_download.html#fw_download">File Firmware Download Request</a></li>
<li><a class="el" href="firmware_download.html#fw_image_data">Binary Image Data for Firmware Download</a></li>
<li><a class="el" href="firmware_download.html#fw_complete">Firmware Download Complete</a></li>
<li><a class="el" href="firmware_download.html#fw_abort">Firmware Download Abort</a></li>
<li><a class="el" href="firmware_download.html#fw_reset">Firmware Target Reset</a></li>
</ol>
<h2><a class="anchor" id="fw_overview"></a>
Overview</h2>
<p>The firmware access facility is an optional facility for applications to update their firmware. The IIK invokes the application-defined callback to query whether this firmware access facility is supported or not. The firmware access facility uses a target number to distinguish application-dependent firmware images. For example, a stand-alone bootloader may be loaded separate from an application image, or a default file system could be maintained as well. Applications define an image to each target except target 0 (target 0 must be the firmware image that is running the IIK). Only one firmware upgrade can be in progress at any given time. The IIK will send a firmware target list to the iDigi server to identify the number of target applications and the version number of each target.</p>
<p>The firmware portion of the application-defined callback is used for the following:</p>
<ol type="1">
<li>To obtain the number of firmware downloadable images.</li>
<li>To obtain firmware image information and descriptions.</li>
<li>To process firmware image upgrades.</li>
<li>To reset firmware images.</li>
</ol>
<p>A typical application-defined callback sequence for downloading a firmware image would include:</p>
<ol type="1">
<li>IIK calls application-defined callback to return firmware information which includes the firmware version number, maximum size of an image, firmware description, and file name spec.</li>
<li>IIK calls application-defined callback to initiate firmware download.</li>
<li>IIK calls application-defined callback for firmware binary data.</li>
<li>Repeat step 3 until the entire firmware image data is completed.</li>
<li>calls application-defined callback to complete firmware download.</li>
<li>calls application-defined callback to reset and reboot the target to begin executing the new firmware.</li>
<li>IIK calls application-defined callback to disconnect the current connection</li>
</ol>
<p>Applications may choose to begin writing their downloaded image to Flash either during the Firmware Binary or Firmware Download Complete message. This is an application level decision with clear tradeoffs (memory needs versus power loss protection). If you write to Flash while the Firmware Binary data is being received, you could lose communication or power at some later time. If protection is built in (i.e., back up images) this would not be problem. If protections are not built in, applications might choose to place the entire image contents into RAM before writing to Flash. Back up image protection would still protect against power loss after your write occurred, but the communication loss or corruption could be avoided by having a checksum test before starting your Flash write.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>See <a class="el" href="config_callbacks.html#firmware_support">Firmware Access Support</a> under Configuration to enable or disable firmware download.</dd></dl>
<h2><a class="anchor" id="fw_num_targets"></a>
Number of Firmware Targets</h2>
<p>Return the number of targets for firmware download.</p>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbaff9f25fb10ad0e666f9a869106d45c01">idigi_firmware_target_count</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to timeout value which callback must return control back to IIK in seconds</td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of unsigned timeout value</td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Pointer to 2-byte integer memory where callback writes the number of supported targets</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Successfully returned the number of targets supported</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIKArguments</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbaff9f25fb10ad0e666f9a869106d45c01">idigi_firmware_target_count</a>)
     {
          <span class="comment">/* return total number of firmware update targets */</span>
          *((<a class="code" href="group__user__types.html#ga273cf69d639a59973b6019625df33e30">uint16_t</a> *)response_data) = firmware_list_count;
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_version_number"></a>
Version Number of Firmware Target</h2>
<p>Return the version number of the target.</p>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbaefbc9c68bac0573bc8721505b4da1c2c">idigi_firmware_version</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Pointer to 4-byte integer memory where callback writes version number</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback successfully returned version number</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIKArguments</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbaefbc9c68bac0573bc8721505b4da1c2c">idigi_firmware_version</a>)
     {
          <a class="code" href="structidigi__fw__config__t.html">idigi_fw_config_t</a> * config = (<a class="code" href="structidigi__fw__config__t.html">idigi_fw_config_t</a> *)request_data;
          <a class="code" href="group__user__types.html#ga06896e8c53f721507066c079052171f8">uint32_t</a> * version = (<a class="code" href="group__user__types.html#ga06896e8c53f721507066c079052171f8">uint32_t</a> *)response_data;
          <span class="comment">/* return the target version number */</span>
          *version = firmware_list[config-&gt;<a class="code" href="structidigi__fw__config__t.html#a5f333beb3be5b82c1e091308136aeb7d">target</a>].version;
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_code_size"></a>
Code Size of Firmware Target</h2>
<p>Return the code size that is currently stored for the target.</p>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba0116c95ba65ed647fc0ca5fd8adda4cf">idigi_firmware_code_size</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Pointer to 4-byte integer memory where callback writes code size. If size is unknown, returns 0xFFFFFFFF.</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback successfully returned image size</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba0116c95ba65ed647fc0ca5fd8adda4cf">idigi_firmware_code_size</a>)
     {
          <a class="code" href="structidigi__fw__config__t.html">idigi_fw_config_t</a> * config = (<a class="code" href="structidigi__fw__config__t.html">idigi_fw_config_t</a> *)request_data;
          <span class="comment">/* Return the target code size */</span>
          <a class="code" href="group__user__types.html#ga06896e8c53f721507066c079052171f8">uint32_t</a> * code_size = (<a class="code" href="group__user__types.html#ga06896e8c53f721507066c079052171f8">uint32_t</a> *)response_data;
          *code_size = firmware_list[config-&gt;<a class="code" href="structidigi__fw__config__t.html#a5f333beb3be5b82c1e091308136aeb7d">target</a>].code_size;
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_description"></a>
Description of Firmware Target</h2>
<p>Return the description of the target.</p>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbade145a9e4183b8c669f046a79dee880b">idigi_firmware_description</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Return pointer to address of an ASCII description string</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>Pointer to memory where callback writes the length of the description string. The total length of description and name spec must not exceed 127 bytes.</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback successfully returned description</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbade145a9e4183b8c669f046a79dee880b">idigi_firmware_description</a>)
     {
          <span class="comment">/* return pointer to firmware target description */</span>
          <span class="keywordtype">char</span> ** description = (<span class="keywordtype">char</span> **)response_data;
          *description = firmware_list[config-&gt;target].description;
          *response_length = strlen(firmware_list[config-&gt;target].description);
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_namespec"></a>
File Name Spec of Firmware Target</h2>
<p>Return the file name spec as a regular expression. No file name spec can be returned if only a single target (target 0) is supported. If an application wants to match the file name "image.bin", it must return "image\.bin" for regular expression. Regular expressions are case sensitive. If file names for the given target are to be case insensitive, it must be specified as case insensitive in a regular expression such as: "[iI][mM][aA][gG][eE]\.[bB][iI][nN]". The maximum length of the firmware description and file name spec combined is 127 bytes.</p>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba65043a17133ff165b15f1515ce11a234">idigi_firmware_name_spec</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Return pointer to address of regular expression string</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>Pointer to memory where callback writes the length of the description string. The total length of description and name spec must not exceed 127 bytes.</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback successfully returned file name spec</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba65043a17133ff165b15f1515ce11a234">idigi_firmware_name_spec</a>)
     {
           <span class="comment">/* return pointer to firmware target description */</span>
          <span class="keywordtype">char</span> ** name_spec = (<span class="keywordtype">char</span> **)response_data;
          *name_spec = firmware_list[config-&gt;target].name_spec;
          *response_length = strlen(firmware_list[config-&gt;target].name_spec);
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_download"></a>
File Firmware Download Request</h2>
<p>Callback is called to start firmware download when IIK receives a firmware download request message. IIK parses the information in the firmware download request and passes the information to the callback:</p>
<ol type="1">
<li>A target number which target the firmware is intended for.</li>
<li>The name of the file to be sent.</li>
</ol>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba208ede78c54be2cef05b7ab1d8013d4c">idigi_firmware_download_request</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__download__request__t.html">idigi_fw_download_request_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__download__request__t.html">idigi_fw_download_request_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Pointer to memory where callback writes the  <a class="el" href="group__idigi__fw__status__t.html">Firmware download return status</a>  to</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback successfully set appropriate status in response_data</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba208ede78c54be2cef05b7ab1d8013d4c">idigi_firmware_download_request</a>)
     {
          <a class="code" href="structidigi__fw__download__request__t.html">idigi_fw_download_request_t</a>  * <span class="keyword">const</span> download_info = request_data;
          <a class="code" href="group__idigi__fw__status__t.html#ga48075d1adccfebe70a3b59f34d47cbc4">idigi_fw_status_t</a> * download_status = response_data;
          <span class="keywordflow">if</span> (firmware_download_started)
          {   <span class="comment">/* already started */</span>
              *download_status = <a class="code" href="group__idigi__fw__status__t.html#gga48075d1adccfebe70a3b59f34d47cbc4a7cbcc9284856e8f2315414248bd2dd73">idigi_fw_device_error</a>;
              <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
          }

          APP_DEBUG(<span class="stringliteral">&quot;target = %d\n&quot;</span>,         download_info-&gt;<a class="code" href="structidigi__fw__download__request__t.html#a5f333beb3be5b82c1e091308136aeb7d">target</a>);
          APP_DEBUG(<span class="stringliteral">&quot;filename = %s\n&quot;</span>,       download_info-&gt;<a class="code" href="structidigi__fw__download__request__t.html#aeac90097f29f7529968697163cea5c18">filename</a>);
          <span class="comment">/* initialize &amp; prepare for firmware update */</span>
          total_image_size = 0;
          firmware_download_started = 1;
          *download_status = <a class="code" href="group__idigi__fw__status__t.html#gga48075d1adccfebe70a3b59f34d47cbc4a8775a64ab07216214066adbcc888eac4">idigi_fw_success</a>;
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_image_data"></a>
Binary Image Data for Firmware Download</h2>
<p>Callback is called to process image data when IIK receives a firmware binary block message. IIK calls this callback for each block of data received from the server. IIK parses the information in the firmware binary block and passes the information to the callback:</p>
<ol type="1">
<li>4-octet offset that determines where the block of binary data fits into the download.</li>
<li>Binary data.</li>
<li>Length of the binary data.</li>
</ol>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbac873c084efff372c00c820c8c48b5a92">idigi_firmware_binary_block</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__image__data__t.html">idigi_fw_image_data_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__image__data__t.html">idigi_fw_image_data_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Pointer to memory where callback writes the  <a class="el" href="group__idigi__fw__status__t.html">Firmware download return status</a>  to</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback successfully set appropriate status in response_data</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da7eeb64c92e877a42a8592a8b05a4ade8">idigi_callback_busy</a>  </td>
 <td>Callback is busy and will be called again with same binary image data</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbac873c084efff372c00c820c8c48b5a92">idigi_firmware_binary_block</a>)
     {
          <a class="code" href="structidigi__fw__image__data__t.html">idigi_fw_image_data_t</a> * <span class="keyword">const</span> image_data = request_data;
          <a class="code" href="group__idigi__fw__status__t.html#ga48075d1adccfebe70a3b59f34d47cbc4">idigi_fw_status_t</a> * data_status = response_data;

          fwStoreImage(image_data-&gt;<a class="code" href="structidigi__fw__image__data__t.html#a5f333beb3be5b82c1e091308136aeb7d">target</a>, image_data-&gt;<a class="code" href="structidigi__fw__image__data__t.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, image_data-&gt;<a class="code" href="structidigi__fw__image__data__t.html#ae809d5359ac030c60a30a8f0b2294b82">length</a>, image_data-&gt;<a class="code" href="structidigi__fw__image__data__t.html#a894bdfa2d603d8343f8ef01dda6fcd23">offset</a>);
          *data_status = <a class="code" href="group__idigi__fw__status__t.html#gga48075d1adccfebe70a3b59f34d47cbc4a8775a64ab07216214066adbcc888eac4">idigi_fw_success</a>;
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_complete"></a>
Firmware Download Complete</h2>
<p>Callback is called when server is done sending all image data. This callback tells IIK when target has been completely updated. If this callback returns:</p>
<ol type="1">
<li>BUSY status indicating the firmware download is still in process, IIK will call this callback again. This usually indicates that image data is still being written onto flash.</li>
<li>CONTINUE status indicating the firmware download has been successfully completed, IIK will send a firmware download complete response to the server.</li>
<li>ABORT status, IIK will send a firmware download abort message to the server, stop and exit with error status.</li>
</ol>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbac5b57039a7c24d55ac5fd53bf1ac2010">idigi_firmware_download_complete</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__download__complete__request__t.html">idigi_fw_download_complete_request_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__download__complete__request__t.html">idigi_fw_download_complete_request_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>Pointer to memory where callback writes the  <a class="el" href="structidigi__fw__download__complete__response__t.html">idigi_fw_download_complete_response_t</a>  to</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback successfully set appropriate status in response_data</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da7eeb64c92e877a42a8592a8b05a4ade8">idigi_callback_busy</a>  </td>
 <td>Callback is busy and will be called again</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbbac5b57039a7c24d55ac5fd53bf1ac2010">idigi_firmware_download_complete</a>)
     {
         <a class="code" href="structidigi__fw__download__complete__request__t.html">idigi_fw_download_complete_request_t</a> * <span class="keyword">const</span> complete_request = request_data;
         <a class="code" href="structidigi__fw__download__complete__response__t.html">idigi_fw_download_complete_response_t</a> * complete_response = response_data;

         <span class="keywordflow">if</span> (complete_request-&gt;<a class="code" href="structidigi__fw__download__complete__request__t.html#a83695968739235b50c7f1baca565c97b">code_size</a> != total_image_size)
         {
             complete_response-&gt;<a class="code" href="structidigi__fw__download__complete__response__t.html#ac43f843299c5e5c158fc975468099d4d">status</a> = <a class="code" href="group__idigi__fw__download__complete__status__t.html#ggaffcec09491fc787f59a32953db5342caa314990717d00a84c1ec5b9a05d0a73c8">idigi_fw_download_not_complete</a>;
         }
         <span class="keywordflow">else</span>
         {
            complete_response-&gt;<a class="code" href="structidigi__fw__download__complete__response__t.html#ac43f843299c5e5c158fc975468099d4d">status</a> = <a class="code" href="group__idigi__fw__download__complete__status__t.html#ggaffcec09491fc787f59a32953db5342caafc21319894f6d0d63866ce217917e937">idigi_fw_download_success</a>;
         }

         fwCloseImage(complete_request-&gt;<a class="code" href="structidigi__fw__download__complete__request__t.html#a5f333beb3be5b82c1e091308136aeb7d">target</a>, complete_response-&gt;<a class="code" href="structidigi__fw__download__complete__response__t.html#ac43f843299c5e5c158fc975468099d4d">status</a>);
         firmware_download_started = 0;
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_abort"></a>
Firmware Download Abort</h2>
<p>Called to abort firmware download when IIK receives a firmware download abort message. *</p>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba1c475dccb772fa4c2e8849311a08de66">idigi_firmware_download_abort</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__download__abort__t.html">idigi_fw_download_abort_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__download__abort__t.html">idigi_fw_download_abort_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>N/A</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback acknowledged that server aborted download process</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == digi_firmware_abort)
     {
         <a class="code" href="structidigi__fw__download__abort__t.html">idigi_fw_download_abort_t</a> * <span class="keyword">const</span> abort_data = request_data;
         fwCloseImage(abort_data-&gt;<a class="code" href="structidigi__fw__download__abort__t.html#a5f333beb3be5b82c1e091308136aeb7d">target</a>, abort_data-&gt;<a class="code" href="structidigi__fw__download__abort__t.html#a060e22a430a68bb512f4443f554c69b3">status</a>);
         firmware_download_started = 0;
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div><h2><a class="anchor" id="fw_reset"></a>
Firmware Target Reset</h2>
<p>Callback is called when server resets target. The callback should not return if it's resetting itself. It may return and continue. However, server may disconnect the device.</p>
 
 <table class="apitable">
 <tr> <th colspan="2" class="title">Arguments</th> </tr> 
 <tr><th class="subtitle">Name</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td>class_id</td>
 <td> <a class="el" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a>  </td>
 </tr>
 <tr>
 <td>request_id</td>
 <td> <a class="el" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba7c9f4672c033686326c33022bf743b96">idigi_firmware_target_reset</a>  </td>
 </tr>
 <tr>
 <td>request_data</td>
 <td>Pointer to  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>request_length</td>
 <td>Size of  <a class="el" href="structidigi__fw__config__t.html">idigi_fw_config_t</a>  </td>
 </tr>
 <tr>
 <td>response_data</td>
 <td>N/A</td>
 </tr>
 <tr>
 <td>response_length</td>
 <td>N/A</td>
 </tr>
 <tr> <th colspan="2" class="title">Return Values</th> </tr> 
 <tr><th class="subtitle">Values</th> <th class="subtitle">Description</th></tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>  </td>
 <td>Callback acknowledged that server reset the target</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458da77b6cf49c4a1cb6d18489ec31112d7fa">idigi_callback_abort</a>  </td>
 <td>Callback aborted IIK</td>
 </tr>
 </table>
 <p>Example:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__idigi__callback__status__t.html#gaada37d2b3520ae3522ccf0ed368f458d">idigi_callback_status_t</a> idigi_callback(<a class="code" href="group__idigi__class__t.html#ga3d9da89a031dfb425e963b0ae7bfbf33">idigi_class_t</a> <span class="keyword">const</span> class_id, <a class="code" href="unionidigi__request__t.html">idigi_request_t</a> <span class="keyword">const</span> request_id
                              <span class="keywordtype">void</span> * <span class="keyword">const</span> request_data, <span class="keywordtype">size_t</span> <span class="keyword">const</span> request_length,
                              <span class="keywordtype">void</span> * response_data, <span class="keywordtype">size_t</span> * <span class="keyword">const</span> response_length)
 {

     <span class="keywordflow">if</span> (class_id = <a class="code" href="group__idigi__class__t.html#gga3d9da89a031dfb425e963b0ae7bfbf33ad6c4a77a422f2d4bd718505a6addd22f">idigi_class_firmware</a> &amp;&amp; request_id.firmware_request == <a class="code" href="group__idigi__firmware__request__t.html#gga6103d29bb1fc7bce55723ef7ac8d9fbba7c9f4672c033686326c33022bf743b96">idigi_firmware_target_reset</a>)
     {
         <a class="code" href="structidigi__fw__config__t.html">idigi_fw_config_t</a> * config = (<a class="code" href="structidigi__fw__config__t.html">idigi_fw_config_t</a> *)request_data;
         fwResetImage(config-&gt;<a class="code" href="structidigi__fw__config__t.html#a5f333beb3be5b82c1e091308136aeb7d">target</a>);
     }
     <span class="keywordflow">return</span> <a class="code" href="group__idigi__callback__status__t.html#ggaada37d2b3520ae3522ccf0ed368f458dabda2f93a62bdf6914f7c2f1736b59e94">idigi_callback_continue</a>;
 }
</pre></div> </div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer">
<center>
<a href="http://www.idigi.com">
</a> Copyright 1996-2011 Digi International Inc. All rights reserved.
</center>
</address>

</body>
</html>
