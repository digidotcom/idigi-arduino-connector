<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    
    <title>iDigi Integration Kit</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
    
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    
    <script type="text/javascript" src="utils.js"></script>
  </head>
<body onload="navlink()">
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><a href="index.html"><img alt="Logo" src="logo-idigi.gif"/></a></td>
  
  
  
   
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">iDigi Integration Kit </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock">
<table><tr>
<td valign="top">
  <div class="navtable" id='navtable' height='100%'>
  <div style='margin: 5px'>
    <ul class='NoBulletNoIndent'>
      <h4>Documentation</h4>
      <li><a href="index.html">Overview</a></li>
      <li><a href="getting_started.html">Getting Started</a></li>
      <li><a href="web_services.html">iDigi Web Services</a></li>

      <h4>API Details</h4>
      <li><a href="api_overview.html">Public API Overview</a></li>
      <li><a href="os_callbacks.html">Operating System</a></li>
      <li><a href="network_callbacks.html">Network</a></li>
      <li><a href="config_callbacks.html">Configuration</a></li>
      <li><a href="data_service.html">Data Service</a></li>
      <li><a href="firmware_download.html">Firmware Download</a></li>
      <li><a href="globals.html">Index</a></li>

      <h4>Samples</h4>
      <li><a href="send_data.html">Send Data</a></li>
      <li><a href="device_request_sample.html">Device Request</a></li>
      <li><a href="fw_download_sample.html">Firmware Download</a></li>

      <h4>More Info</h4>
      <li><a href="../../private/Readme.txt">Release Notes</a></li>
      <li><a href="../../iDigi Integration Kit End-User License Agreement.pdf">License</a></li>

      <h4>Support</h4>
      <li><a href="http://www.digi.com/contactus/email.jsp">Contact Support</a></li>
      <li><a href="http://www.digi.com/support">Support</a></li>
      <li><a href="http://forums.digi.com/support/forum/index">Discussion Forums</a></li>
    </ul>      
   </div>
   </div>
</td>
<td id='maintable' width="100%" valign="top">

<h2><a class="anchor" id="table_of_contents"></a>
Overview</h2>
<ol type="1">
<li><a class="el" href="index.html#intro">Introduction</a></li>
<li><a class="el" href="index.html#language">Language Support</a></li>
<li><a class="el" href="index.html#requirements">Platform Memory Requirements</a><ol type="a">
<li><a class="el" href="index.html#CodespaceRequirements">Code Space Estimates</a></li>
<li><a class="el" href="index.html#RAMRequirements">Dynamic RAM Usage</a></li>
<li><a class="el" href="index.html#StackRequirements">Program Stack Usage</a></li>
</ol>
</li>
<li><a class="el" href="index.html#features">IIK Features</a></li>
<li><a class="el" href="index.html#communicating">Communicating with your device</a></li>
<li><a class="el" href="index.html#threading">Threading Model</a></li>
<li><a class="el" href="index.html#code_organization">Source Code Organization</a><ol type="a">
<li><a class="el" href="index.html#DirectoryStructure">Directory Structure</a></li>
<li><a class="el" href="index.html#AppStructure">Source Code Hierarchy</a></li>
<li><a class="el" href="index.html#PortingFocus">Porting Guidelines</a></li>
<li><a class="el" href="index.html#DebugTips">How to debug your Port</a></li>
</ol>
</li>
<li><a class="el" href="index.html#the_getting_started_process">Getting Started</a></li>
</ol>
<h2><a class="anchor" id="intro"></a>
Introduction</h2>
<p>The iDigi Integration Kit (IIK) is a software development package used to communicate and exchange information between a device and the iDigi Device Cloud. iDigi supports application to device data interaction (messaging), application &amp; device data storage, and remote management of devices. Devices are associated with the iDigi Device Cloud through the Internet or other wide area network connections, which allows for communication between the device, the iDigi Device Cloud, and customer applications. An important part of this communication is the transfer of data from a device to the iDigi Device Cloud. iDigi is based upon a cloud computing model that provides on-demand scalability so you can rest assured that when you need additional computing and storage, iDigi will scale to meet your needs. The iDigi Device Cloud is designed using a high-availability architecture, with redundancy and failover characteristics in mind. Using iDigi, customers can now easily develop cloud connected devices and applications that quickly scale from dozens to hundreds, thousands or even millions of endpoints.</p>
<div class="image">
<img src="cloud.jpg" alt="cloud.jpg"/>
</div>
<h2><a class="anchor" id="language"></a>
Language Support</h2>
<p>The IIK software provided is ANSI X3.159-1989 (ANSI C89) and ISO/IEC 9899:1999 (ANSI C99) compliant. The sample platforms provided use standard ANSI C calls which are available in most operating systems. If you are running on a Linux i486 based platform and using the GNU toolchain the Linux platform and samples can be run without any modifications.</p>
<h2><a class="anchor" id="requirements"></a>
Platform Memory Requirements</h2>
<p>The IIK requires both Flash and RAM. Flash is needed to store instructions and variables. RAM is needed for dynamic allocation and program stack.</p>
<h3><a class="anchor" id="CodespaceRequirements"></a>
Code Space Estimates</h3>
<p>The following Flash/Code space data was generated using Ubuntu 4.4.3 gcc for 32-bit i486 architecture using the <a class="el" href="getting_started.html#step3">compile_and_link</a> sample application. The build was optimized for size (-Os) with <a class="el" href="group__idigi__config__options.html#ga72ce58ac068c07d045fab82e533e66c3">IDIGI_COMPRESSION</a> disabled in all cases. The metrics exclude any code space required for application layer calls. This information should be treated as a typical use case.</p>
 
 <table class="apitable">
 <tr>
 <th class="title">IIK Service Options and Configuration Methodology</td>
 <th class="title">Text</td>
 <th class="title">rodata</td>
 <th class="title">data</td>
 <th class="title">bss</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__config__options.html#gae0a42315e30656478ca8748a88defed1">IDIGI_DEBUG</a>, <a class="el" href="group__idigi__config__options.html#ga5074ea59b410e19b2ff42384df3c7596">IDIGI_FIRMWARE_SERVICE</a>, <a class="el" href="group__idigi__config__options.html#gaaad7706066d1b5b8d5d5f59a51dbc7b4">IDIGI_DATA_SERVICE</a>  enabled.</td>
 <td>20285</td>
 <td>6840</td>
 <td>0</td>
 <td>12</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__config__options.html#ga5074ea59b410e19b2ff42384df3c7596">IDIGI_FIRMWARE_SERVICE</a>, <a class="el" href="group__idigi__config__options.html#gaaad7706066d1b5b8d5d5f59a51dbc7b4">IDIGI_DATA_SERVICE</a>  enabled.</td>
 <td>16400</td>
 <td>372</td>
 <td>0</td>
 <td>0</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__config__options.html#ga5074ea59b410e19b2ff42384df3c7596">IDIGI_FIRMWARE_SERVICE</a>, <a class="el" href="group__idigi__config__options.html#gaaad7706066d1b5b8d5d5f59a51dbc7b4">IDIGI_DATA_SERVICE</a> enabled. <a class="el" href="group__idigi__config__data__options.html">Hard Coded Application Configuration options</a> used.  </td>
 <td>15545</td>
 <td>372</td>
 <td>0</td>
 <td>0</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__config__options.html#ga5074ea59b410e19b2ff42384df3c7596">IDIGI_FIRMWARE_SERVICE</a> enabled. <a class="el" href="group__idigi__config__data__options.html">Hard Coded Application Configuration options</a> used.  </td>
 <td>9813</td>
 <td>280</td>
 <td>0</td>
 <td>0</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__config__options.html#gaaad7706066d1b5b8d5d5f59a51dbc7b4">IDIGI_DATA_SERVICE</a> enabled. <a class="el" href="group__idigi__config__data__options.html">Hard Coded Application Configuration options</a> used.  </td>
 <td>12413</td>
 <td>244</td>
 <td>0</td>
 <td>0</td>
 </tr>
 </table>
 <p>References to Text, rodata, data, and bss refer to program instructions, constant-read-only data, initialized global and static variables, and uninitialized zero-ed data, respectively. References to the <a class="el" href="group__idigi__config__data__options.html">Hard Coded Application Configuration options</a> refers to the code reduction defines in <a class="el" href="idigi__config_8h.html" title="IIK configuration options.">idigi_config.h</a>: <a class="el" href="group__idigi__config__data__options.html#ga4221964c6d18cb2ae13ea013bbdb59a5">IDIGI_DEVICE_TYPE</a>, <a class="el" href="group__idigi__config__data__options.html#ga60891b6d018c55fb485249ff30505552">IDIGI_CLOUD_URL</a>, <a class="el" href="group__idigi__config__data__options.html#ga9ccf5445ffd00b6f32cc55b1ad2eb2f9">IDIGI_TX_KEEPALIVE_IN_SECONDS</a>, <a class="el" href="group__idigi__config__data__options.html#gac6fd28bb6adb328198ff1291d727134d">IDIGI_RX_KEEPALIVE_IN_SECONDS</a>, <a class="el" href="group__idigi__config__data__options.html#ga922f2177c38b261c0d31e5be82202518">IDIGI_WAIT_COUNT</a>, <a class="el" href="group__idigi__config__data__options.html#ga4ea48ae34e68af5ebe57be7a34af6b5b">IDIGI_VENDOR_ID</a>, <a class="el" href="group__idigi__config__data__options.html#ga06c34f05315a4ff63c52dfd5b1c2389d">IDIGI_MSG_MAX_TRANSACTION</a>, <a class="el" href="group__idigi__config__data__options.html#ga31c8044a6002c12948d147377f9a33d1">IDIGI_CONNECTION_TYPE</a>, <a class="el" href="group__idigi__config__data__options.html#ga8ed061746004e576de7090bdeaa1d3ed">IDIGI_WAN_LINK_SPEED_IN_BITS_PER_SECOND</a>, <a class="el" href="group__idigi__config__data__options.html#gab8945fd8920fee10aadff993f07d3860">IDIGI_WAN_PHONE_NUMBER_DIALED</a>, <a class="el" href="group__idigi__config__data__options.html#gabb2866812d6f75b61c5abe030722d47b">IDIGI_FIRMWARE_SUPPORT</a>, and <a class="el" href="group__idigi__config__data__options.html#ga363ade773ebefc762aeb1d3f125c58b6">IDIGI_DATA_SERVICE_SUPPORT</a>.</p>
<h3><a class="anchor" id="RAMRequirements"></a>
Dynamic RAM Usage</h3>
<p>The following dynamic RAM usage was developed by monitoring the high-water mark during the <a class="el" href="group__idigi__os__request__t.html#ggabed3a19de0949244d6bdcfcd81fc8829a9af72b4e6d7babfeedfbda200cf4e712">idigi_os_malloc</a> <a class="el" href="group__idigi__callback__t.html">application-defined callback</a>.</p>
 
 <table class="apitable">
 <tr>
 <th class="title">Description</td>
 <th class="title">IDIGI_COMPRESSION enabled</td>
 <th class="title">IDIGI_COMPRESSION disabled</td>
 <th class="title">Notes</td>
 </tr>
 <tr>
 <td>IIK Base usage</td>
 <td>2436</td>
 <td>2436</td>
 <td>Memory usage for internal state machines, infrastructure and communication buffers</td>
 </tr>
 <tr>
 <td>With  <a class="el" href="group__idigi__config__options.html#ga5074ea59b410e19b2ff42384df3c7596">IDIGI_FIRMWARE_SERVICE</a>  enabled</td>
 <td>108</td>
 <td>108</td>
 <td></td>
 </tr>
 <tr>
 <td>With  <a class="el" href="group__idigi__config__options.html#gaaad7706066d1b5b8d5d5f59a51dbc7b4">IDIGI_DATA_SERVICE</a>  enabled</td>
 <td>92 + 3320*n</td>
 <td>92 + 56*n</td>
 <td>Where n is the maximum number of simultaneous message transactions, defined in the  <a class="el" href="group__idigi__config__data__options.html#ga06c34f05315a4ff63c52dfd5b1c2389d">IDIGI_MSG_MAX_TRANSACTION</a>  </td>
 </tr>
 <tr>
 <td>Total</td>
 <td>5920</td>
 <td>2656</td>
 <td>Assumes both  <a class="el" href="group__idigi__config__options.html#ga5074ea59b410e19b2ff42384df3c7596">IDIGI_FIRMWARE_SERVICE</a> and <a class="el" href="group__idigi__config__options.html#ga5074ea59b410e19b2ff42384df3c7596">IDIGI_FIRMWARE_SERVICE</a>  enabled, with n=1 (one data service message transaction maximum)</td>
 </tr>
 </table>
 <h3><a class="anchor" id="StackRequirements"></a>
Program Stack Usage</h3>
<p>The following program stack usage was observed using gcc 4.2.0 compiled for a 32-bit ARM9 TDMI architecture.</p>
 
 <table class="apitable">
 <tr>
 <th class="title">Build Details </td>
 <th class="title"> Program stack size</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__config__options.html#gae0a42315e30656478ca8748a88defed1">IDIGI_DEBUG</a>  disabled</td>
 <td>1723</td>
 </tr>
 <tr>
 <td> <a class="el" href="group__idigi__config__options.html#gae0a42315e30656478ca8748a88defed1">IDIGI_DEBUG</a>  enabled</td>
 <td>2091</td>
 </tr>
 </table>
 <p>This includes all code from within the private IIK library, but none of the code implemented in the <a class="el" href="group__idigi__callback__t.html">application-defined callback</a>. These metrics should be treated as typical. It is recommended that the actual program stack size used to call <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773">idigi_run()</a> or <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a> be these metrics plus the amount of memory typical for handling a TCP network client, or a thread that accesses local configuration, or makes malloc/free OS calls, whichever is the worst case.</p>
<h2><a class="anchor" id="features"></a>
IIK Features</h2>
<ul>
<li>Send data to and from a device using the iDigi Device Cloud </li>
<li>Update firmware on the device </li>
<li>View the device configuration </li>
<li>Reboot a device</li>
</ul>
<h2><a class="anchor" id="communicating"></a>
Communicating with your device</h2>
<p>To manage your device you can use the <a href="http://www.idigi.com/idigimanagerpro">iDigi Manager Pro</a> interface by logging into your <a class="el" href="getting_started.html#step4">iDigi Device Cloud account</a>. Alternatively, you can communicate with your device programmatically by using <a class="el" href="web_services.html">iDigi Web Services</a>.</p>
<p><a class="el" href="web_services.html">iDigi Web Services</a> requests are sent from a remote application to the iDigi Device Cloud, which then directly communicates to the device. This allows for bidirectional machine to machine communication. Each IIK sample includes a Python application demonstrating how to communicate to a device using the <a class="el" href="web_services.html">iDigi Web Services</a>.</p>
<h2><a class="anchor" id="threading"></a>
Threading Model</h2>
<p>The IIK can be deployed in a multithreaded (<a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a>) or round robin control loop (<a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a>) environment. In environments that include preemptive threading, the IIK can be implemented as a separate stand-alone thread by calling <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a>. This is a blocking call that only returns due to a major system failure.</p>
<p>Alternatively, when threading is unavailable, in a round robin control loop or fixed state machine, the IIK can be implemented using the non-blocking <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a> call within the round robin control loop.</p>
<p>Note in a cooperative, non-preemptive multithreaded environment, either <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a> or <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a> can used, based on system determinism and the potential for a non-cooperative thread to exceed the IIK's system timing.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>You should decide before proceeding how you intend to call the IIK (within a round robin control loop or running as a separate thread). In a limited services OS with no real time threading, you should use the <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a> routine. Otherwise you should use the <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a> routine.</dd></dl>
<h2><a class="anchor" id="code_organization"></a>
Source Code Organization</h2>
<p>The IIK source code is divided into two partitions, a private partition and a public Application Framework. The private partition includes the sources that implement the <a class="el" href="api_overview.html">IIK public API</a>. The public Application Framework includes a set of sample applications used for demonstration purposes.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The private partition should be treated as a black box and never used, changed, debugged or referenced directly. It's recommended after completing the <a class="el" href="getting_started.html">Getting Started</a> process that this private partition be converted into a library. Note the term "IIK library" is used synonymously for the "IIK private partition".</dd></dl>
<h3><a class="anchor" id="DirectoryStructure"></a>
Directory Structure</h3>
<p>When uncompressed the directory structure below will be created in the idigi directory. The public directory is divided into a step and run branch to easily distinguish the different thread modeling requirements.</p>
 
 <table class="apitable">
 <tr>
 <th class="title">Directory</td>
 <th class="title">Description</td>
 </tr>
 <tr>
 <td rowspan="2">private</td>
 <td style="border-bottom: 0px none;">IIK Library Code</td>
 </tr><tr>
 <td style="border-top: 0px none;">This directory contains all the private and internal files used to build the IIK library. 
 <b>You should never modify, directly call, debug, or reference any file from this directory</b>.</td>
 </tr>
 <tr>
 <td rowspan=2>public/include</td>
 <td style="border-bottom: 0px none;">  <a class="el" href="api_overview.html">IIK Public API</a>  </td>
 </tr><tr>
 <td style="border-top: 0px none;">Contains the three public headers:  <a class="el" href="idigi__api_8h.html">idigi_api.h</a>, <a class="el" href="idigi__types_8h.html">idigi_types.h</a>, and <a class="el" href="idigi__config_8h.html">idigi_config.h</a>  .  The  <a class="el" href="api_overview.html">IIK Public API</a>  is located in  <a class="el" href="idigi__api_8h.html">idigi_api.h</a>  and
 required for application development.  All the machine device types are located in  <a class="el" href="idigi__types_8h.html">idigi_types.h</a>  and might
 require updating to match your platform's characteristics (i.e., data size and supported compiler data types).  The header  <a class="el" href="idigi__config_8h.html">idigi_config.h</a>  contains all the IIK settings and configurations. </td>
 </tr>
 <tr>
 <td rowspan=2>public/run</td>
 <td style="border-bottom: 0px none;">Platforms and samples for running the IIK as a separate thread</td>
 </tr><tr>
 <td style="border-top: 0px none;">This directory contains platforms and samples that use  <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a>  which runs
 the IIK as a separate thread in a multitasking environment.</td>
 </tr>
 <td rowspan=2>public/run/platforms</td>
 <td style="border-bottom: 0px none;">Platform files for running the IIK as a separate thread</td>
 </tr><tr>
 <td style="border-top: 0px none;">Platform dependent files that interface between the IIK library (private) and the sample applications.
 These files include  <a class="el" href="os_8c.html" title="Functions used by the IIK to interface to the OS.">os.c</a>, <a class="el" href="network_8c.html" title="Rountines which implement the IIK network interface.">network.c</a>, <a class="el" href="config_8c.html" title="Configuration routines for the IIK.">config.c</a>, <a class="el" href="platform_8h_source.html">platform.h</a> and main.c.  
 The Getting Started Procedure walks you through the process of porting and setting these platform files.</td>
 </tr>
 <tr>
 <td rowspan="2">public/run/samples</td>
 <td style="border-bottom: 0px none;">Samples for the IIK</td>
 </tr><tr>
 <td style="border-top: 0px none;">Samples on how to use the IIK, the compile_and_link sample is used to verify
 that your new envirorment is able to build. There is a sample for each major
 feature in the IIK, there is documentation in this guide for each sample.</td>
 </tr>
 <tr>
 <td rowspan=2>public/step</td>
 <td style="border-top: 0px none;">This directory contains platforms and samples that use  <a class="el" href="group__idigi__step.html#ga741cb14e2d5f9274e5c8313d3bf7790b" title="Run a portion of the IIK.">idigi_step()</a>  which makes
 repeated calls within a round robin control loop.</td>
 </tr><tr>
 </table>
 <h3><a class="anchor" id="AppStructure"></a>
Source Code Hierarchy</h3>
<p>The IIK is split into two separate partitions, a private partition and a public Application Framework.</p>
<p>The private partition (IIK Library) includes source code that implements the <a class="el" href="api_overview.html">IIK public API</a>, plus all the internal code used to implement the iDigi Cloud protocol. This private partition should be treated as a black box and never used, changed, debugged or referenced directly.</p>
<p>The public Application Framework partition is further divided in two: a Platform and Sample section. The Platform section is related to system specific porting dependencies (i.e., fleshing out <a class="el" href="os_callbacks.html">operating system</a> calls, <a class="el" href="network_callbacks.html">networking</a>, <a class="el" href="config_callbacks.html">system configuration</a>). The Sample section contains an application structure to cleanly interface between the Platform section and the IIK private partition.</p>
<p>For instance, in a linux run thread model, the main() routine starts two threads: idigi_run_thread() and application_run_thread() in main.c. This file is located in the Platform section since it relies on threads (an operating system dependency). The idigi_run_thread() directly calls the <a class="el" href="api_overview.html">IIK API</a> <a class="el" href="group__idigi__run.html#gabdea7b2d88546bccfabe22349dcca773" title="Run the IIK, this function does not return and is used in a multithreaded environment.">idigi_run()</a>, and the application_run_thread() calls application_run(). The application_run() function has no system dependencies and contains IIK specific functions, therefore, it resides within the Sample section.</p>
<p>In the diagram below, the IIK Library is shown encapsulated within the dotted line on top (in the Private Source Code Area). The bottom is the Platform section, where the bottom left side shows main() calling <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> and spawning the two threads. Also shown is the application_run_thread() calling application_run() in the Sample section. The Sample section is encapsulated within the dotted line on the center-right.</p>
<div class="image">
<img src="SWOverview.jpg" alt="SWOverview.jpg"/>
</div>
<p>Based on the particular sample, application_run() could either make calls to <a class="el" href="group__idigi__initiate__action.html#gabbb64d2c51de0c6f605196e48677b640" title="Request IIK to perform an action.">idigi_initiate_action()</a>, or could just return and complete.</p>
<p>The diagram further shows the IIK Library making callbacks into the Sample section. The <a class="el" href="group__idigi__callback__t.html">application callback function</a>, initially passed to the IIK library via the <a class="el" href="group__idigi__init.html#ga10767cc6668eec9bfc426181af798053">idigi_init()</a> call, will pass the callback request to the appropriate handler, which will either be in the Platform section for <a class="el" href="os_callbacks.html">operating system</a>, <a class="el" href="network_callbacks.html">networking</a>, or <a class="el" href="config_callbacks.html">configuration</a> callbacks; or remain locally handled (in the Sample section) for the Data Service callbacks.</p>
<h3><a class="anchor" id="PortingFocus"></a>
Porting Guidelines</h3>
<p>The IIK <a class="el" href="getting_started.html">Getting Started</a> process includes pulling the IIK into your local build environment, getting the private partition compiled and linked (using the <a class="el" href="getting_started.html#step3">compile_and_link</a> sample) and then your <a class="el" href="getting_started.html#step5">platform ported</a>. Once your platform is ported, you will verify and confirm your port using the <a class="el" href="getting_started.html#step7">connect_to_idigi</a> sample.</p>
<p>When porting, it is strongly recommended that you maintain the structure of the public Application Framework. Once porting, compilation and testing are complete, the you can dismantle this framework and incorporate the IIK into your environment as you see fit.</p>
<p>When reusing the Application Framework, the largest effort will be updating the lowest layer of the Platform code. Specifically, the static <a class="el" href="getting_started.html#os_routines">operating system</a> functions located in <a class="el" href="os_8c.html" title="Functions used by the IIK to interface to the OS.">os.c</a>, the <a class="el" href="getting_started.html#network_routines">networking</a> functions in <a class="el" href="network_8c.html" title="Rountines which implement the IIK network interface.">network.c</a> and the <a class="el" href="getting_started.html#configuration_routines">configuration</a> functions in <a class="el" href="config_8c.html" title="Configuration routines for the IIK.">config.c</a>.</p>
<p>There is no expectation that you will need to port any other code, with the exception of the <a class="el" href="getting_started.html#step1">changes</a> required to get your code compiled.</p>
<p>For example, the Application Framework includes code to handle an <a class="el" href="group__idigi__os__request__t.html#ggabed3a19de0949244d6bdcfcd81fc8829a4ceb1b3a1a475adb93e1723bf8bb1945">idigi_os_system_up_time</a> callback in <a class="el" href="os_8c.html" title="Functions used by the IIK to interface to the OS.">os.c</a>. The function requires a stable system timer at one second resolution. In the linux platform example, the function is implemented using the POSIX standard time() function:</p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">int</span> <a class="code" href="os_8c.html#a389dab616776482cb531e0994fb869c7" title="Get the system time.">app_os_get_system_time</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> * <span class="keyword">const</span> uptime)
 {
    time((time_t *)uptime);

    <span class="keywordflow">return</span> 0;
 }
</pre></div><p>However, a platform that does not support POSIX time() might port this function as such:</p>
<div class="fragment"><pre class="fragment"> <span class="keywordtype">int</span> <a class="code" href="os_8c.html#a389dab616776482cb531e0994fb869c7" title="Get the system time.">app_os_get_system_time</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> * <span class="keyword">const</span> uptime)
 {
    <span class="comment">// Note mysys_GetTickTime() returns the system up time in milliseconds</span>
    <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mysys_GetTickTime(<span class="keywordtype">void</span>);

    *uptime = mysys_GetTickTime()/1000;

    <span class="keywordflow">return</span> 0;
 }
</pre></div><p>After converting all the static <a class="el" href="getting_started.html#os_routines">operating system</a>, <a class="el" href="getting_started.html#network_routines">networking</a>, and <a class="el" href="getting_started.html#configuration_routines">configuration</a> functions, your porting effort is complete.</p>
<h3><a class="anchor" id="DebugTips"></a>
How to debug your Port</h3>
<p>After porting and compiling, you will run the <a class="el" href="getting_started.html#step7">connect_to_idigi</a> sample. We recommend that you carefully observe the standard output from the application. In particular, the <a class="el" href="group__idigi__config__request__t.html#gga48906e16d7c01c72b5549b12d663001cab2b82246aeafc5b3ef69d908cf697d24">idigi_config_error_status</a> callback will display error data when porting errors are detected in the callbacks.</p>
<p>Examples of <a class="el" href="getting_started.html#good_results_output">successful</a> and <a class="el" href="getting_started.html#bad_results_output">erroneous</a> output streams are available.</p>
<h2><a class="anchor" id="the_getting_started_process"></a>
Getting Started</h2>
<p>To get started, follow along the steps of the <a class="el" href="getting_started.html">Getting Started</a> process. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer">
<center>
<a href="http://www.idigi.com">
</a> Copyright 1996-2011 Digi International Inc. All rights reserved.
</center>
</address>

</body>
</html>
